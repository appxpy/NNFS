<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Doxygen Awesome" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<meta property="og:url" content="https://jothepro.github.io/doxygen-awesome-css/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta name="twitter:title" content="Doxygen Awesome" />
<meta name="twitter:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<!-- END twitter metadata -->
<title>NNFS: tools/mnist.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/appxpy/NNFS" class="github-corner" title="View source on GitHub" target="_blank">
    <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <svg width="44" height="44" viewBox="0 0 48 49" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect width="48" height="48" transform="translate(0 0.219971)" fill="var(--page-foreground-color)"/>
        <path d="M13.44 23.22V10.62H15.186L20.856 20.484V10.62H22.422V23.22H20.694L15.024 13.356V23.22H13.44ZM25.3052 23.22V10.62H27.0512L32.7212 20.484V10.62H34.2872V23.22H32.5592L26.8892 13.356V23.22H25.3052ZM13.44 37.22V24.62H20.604V26.096H15.078V30.65H20.604V32.126H15.078V37.22H13.44ZM30.3156 37.508C28.8876 37.508 27.7716 37.13 26.9676 36.374C26.1636 35.618 25.7616 34.562 25.7616 33.206H27.3996C27.3996 34.082 27.6576 34.778 28.1736 35.294C28.7016 35.81 29.4096 36.068 30.2976 36.068C31.0896 36.068 31.7016 35.888 32.1336 35.528C32.5656 35.156 32.7816 34.64 32.7816 33.98C32.7816 33.428 32.6256 32.984 32.3136 32.648C32.0136 32.312 31.4976 32.018 30.7656 31.766L28.6776 31.028C26.9856 30.488 26.1396 29.384 26.1396 27.716C26.1396 26.708 26.5056 25.892 27.2376 25.268C27.9696 24.644 28.9236 24.332 30.0996 24.332C31.3356 24.332 32.3256 24.68 33.0696 25.376C33.8136 26.072 34.1856 27.008 34.1856 28.184H32.5476C32.5476 27.404 32.3316 26.804 31.8996 26.384C31.4676 25.952 30.8496 25.736 30.0456 25.736C29.3496 25.736 28.7976 25.91 28.3896 26.258C27.9936 26.594 27.7956 27.05 27.7956 27.626C27.7956 28.154 27.9696 28.592 28.3176 28.94C28.6656 29.288 29.2296 29.594 30.0096 29.858L31.9536 30.542C33.6096 31.13 34.4376 32.264 34.4376 33.944C34.4376 35.012 34.0596 35.876 33.3036 36.536C32.5596 37.184 31.5636 37.508 30.3156 37.508Z" fill="var(--page-background-color)"/>
    </svg>
  </td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NNFS
   </div>
   <div id="projectbrief">Neural network library from scratch</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mnist_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">mnist.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="mnist_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;random&gt;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;filesystem&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;Eigen/Core&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span> </div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;curl/curl.h&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;zlib.h&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno"><a class="line" href="mnist_8cpp.html#a090e85bf3b44a471480e17b14f33ccca">   20</a></span><span class="keyword">const</span> std::string <a class="code hl_variable" href="mnist_8cpp.html#a090e85bf3b44a471480e17b14f33ccca">BASE_URL</a> = <span class="stringliteral">&quot;http://yann.lecun.com/exdb/mnist/&quot;</span>;</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno"><a class="line" href="mnist_8cpp.html#acde73c899ec0618eeb8ae54b0a823f39">   27</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="mnist_8cpp.html#acde73c899ec0618eeb8ae54b0a823f39">file_exists</a>(<span class="keyword">const</span> std::string &amp;filename)</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>{</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>    std::ifstream infile(filename);</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>    <span class="keywordflow">return</span> infile.good();</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>}</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="keyword">static</span> <span class="keywordtype">size_t</span> write_data(<span class="keywordtype">void</span> *ptr, <span class="keywordtype">size_t</span> size, <span class="keywordtype">size_t</span> nmemb, <span class="keywordtype">void</span> *stream)</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>{</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>    <span class="keywordtype">size_t</span> written = fwrite(ptr, size, nmemb, (FILE *)stream);</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    <span class="keywordflow">return</span> written;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>}</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno"><a class="line" href="mnist_8cpp.html#a7c63282ad68df1a95e0403260865011c">   44</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="mnist_8cpp.html#a7c63282ad68df1a95e0403260865011c">download_file</a>(<span class="keyword">const</span> std::string &amp;url, <span class="keyword">const</span> std::string &amp;path)</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>{</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    CURL *curl_handle;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    FILE *out;</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    curl_global_init(CURL_GLOBAL_ALL);</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    <span class="comment">/* init the curl session */</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    curl_handle = curl_easy_init();</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    <span class="comment">/* set URL to get here */</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    curl_easy_setopt(curl_handle, CURLOPT_URL, url.c_str());</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    <span class="comment">/* Switch on full protocol/debug output while testing */</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    curl_easy_setopt(curl_handle, CURLOPT_VERBOSE, 1L);</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <span class="comment">/* disable progress meter, set to 0L to enable and disable debug output */</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    curl_easy_setopt(curl_handle, CURLOPT_NOPROGRESS, 1L);</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <span class="comment">/* send all data to this function  */</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    curl_easy_setopt(curl_handle, CURLOPT_WRITEFUNCTION, write_data);</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    <span class="comment">/* open the file */</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    out = fopen(path.c_str(), <span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <span class="keywordflow">if</span> (out)</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    {</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span> </div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>        <span class="comment">/* write the page body to this file handle */</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>        curl_easy_setopt(curl_handle, CURLOPT_WRITEDATA, out);</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        <span class="comment">/* get it! */</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>        curl_easy_perform(curl_handle);</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>        <span class="comment">/* close the header file */</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>        fclose(out);</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    }</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <span class="comment">/* cleanup curl stuff */</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    curl_easy_cleanup(curl_handle);</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    curl_global_cleanup();</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>}</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno"><a class="line" href="mnist_8cpp.html#a0cff9e7b5af8c9ddca0cad993e41f7a2">   93</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="mnist_8cpp.html#a0cff9e7b5af8c9ddca0cad993e41f7a2">unzip_file</a>(<span class="keyword">const</span> std::string &amp;gz_path, <span class="keyword">const</span> std::string &amp;out_path)</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>{</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    gzFile gz = gzopen(gz_path.c_str(), <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    <span class="keywordflow">if</span> (!gz)</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    {</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;Error opening gz file: &quot;</span> &lt;&lt; gz_path &lt;&lt; std::endl;</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    }</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    std::ofstream outfile(out_path, std::ofstream::binary);</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    <span class="keywordflow">if</span> (!outfile.is_open())</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    {</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;Error opening output file: &quot;</span> &lt;&lt; out_path &lt;&lt; std::endl;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    }</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    <span class="keywordtype">char</span> buffer[1024];</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    <span class="keywordtype">int</span> uncompressed_bytes;</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    <span class="keywordflow">while</span> ((uncompressed_bytes = gzread(gz, buffer, <span class="keyword">sizeof</span>(buffer))) &gt; 0)</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    {</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>        outfile.write(buffer, uncompressed_bytes);</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    }</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    outfile.close();</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    gzclose(gz);</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span> </div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>}</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno"><a class="line" href="mnist_8cpp.html#a1491b509fa59f2feb172a47697453bf9">  128</a></span>Eigen::MatrixXd <a class="code hl_function" href="mnist_8cpp.html#a1491b509fa59f2feb172a47697453bf9">read_mnist_images</a>(<span class="keyword">const</span> std::string &amp;filename)</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>{</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    std::ifstream file(filename, std::ios::binary);</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    <span class="keywordflow">if</span> (!file)</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    {</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Error: Failed to open file: &quot;</span> &lt;&lt; filename.c_str() &lt;&lt; std::endl;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>        <span class="keywordflow">return</span> Eigen::MatrixXd();</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    }</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span> </div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    <span class="keywordtype">int</span> magic_number = 0;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    <span class="keywordtype">int</span> num_images = 0;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="keywordtype">int</span> num_rows = 0;</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    <span class="keywordtype">int</span> num_cols = 0;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span> </div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    file.read((<span class="keywordtype">char</span> *)&amp;magic_number, <span class="keyword">sizeof</span>(magic_number));</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    magic_number = ntohl(magic_number);</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    <span class="keywordflow">if</span> (magic_number != 2051)</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    {</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Error: Invalid magic number in file: &quot;</span> &lt;&lt; filename.c_str() &lt;&lt; std::endl;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        <span class="keywordflow">return</span> Eigen::MatrixXd();</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    }</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span> </div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    file.read((<span class="keywordtype">char</span> *)&amp;num_images, <span class="keyword">sizeof</span>(num_images));</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    file.read((<span class="keywordtype">char</span> *)&amp;num_rows, <span class="keyword">sizeof</span>(num_rows));</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    file.read((<span class="keywordtype">char</span> *)&amp;num_cols, <span class="keyword">sizeof</span>(num_cols));</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    num_images = ntohl(num_images);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    num_rows = ntohl(num_rows);</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>    num_cols = ntohl(num_cols);</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span> </div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    Eigen::MatrixXd images(num_rows * num_cols, num_images);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_images; ++i)</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    {</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; num_rows * num_cols; ++j)</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        {</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> pixel = 0;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>            file.read((<span class="keywordtype">char</span> *)&amp;pixel, <span class="keyword">sizeof</span>(pixel));</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>            images(j, i) = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(pixel) / 255.;</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        }</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    }</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    <span class="keywordflow">return</span> images.transpose();</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>}</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno"><a class="line" href="mnist_8cpp.html#a17d523ce09d4ae1a3b498017aa857a9d">  179</a></span>Eigen::MatrixXd <a class="code hl_function" href="mnist_8cpp.html#a17d523ce09d4ae1a3b498017aa857a9d">read_mnist_labels</a>(<span class="keyword">const</span> std::string &amp;filename)</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>{</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    std::ifstream file(filename, std::ios::binary);</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    <span class="keywordflow">if</span> (!file)</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    {</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Error: Failed to open file: &quot;</span> &lt;&lt; filename.c_str() &lt;&lt; std::endl;</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>        <span class="keywordflow">return</span> Eigen::MatrixXd();</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    }</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span> </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <span class="keywordtype">int</span> magic_number = 0;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <span class="keywordtype">int</span> num_labels = 0;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    file.read((<span class="keywordtype">char</span> *)&amp;magic_number, <span class="keyword">sizeof</span>(magic_number));</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    magic_number = ntohl(magic_number);</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="keywordflow">if</span> (magic_number != 2049)</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    {</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Error: Invalid magic number in file: &quot;</span> &lt;&lt; filename.c_str();</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>        <span class="keywordflow">return</span> Eigen::MatrixXd();</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    }</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    file.read((<span class="keywordtype">char</span> *)&amp;num_labels, <span class="keyword">sizeof</span>(num_labels));</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    num_labels = ntohl(num_labels);</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    Eigen::MatrixXd labels = Eigen::MatrixXd::Zero(10, num_labels);</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_labels; ++i)</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    {</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> label = 0;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        file.read((<span class="keywordtype">char</span> *)&amp;label, <span class="keyword">sizeof</span>(label));</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        <span class="keywordtype">int</span> index = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(label);</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>        labels(index, i) = 1.0;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    }</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    <span class="keywordflow">return</span> labels.transpose();</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>}</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span> </div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>std::tuple&lt;Eigen::MatrixXd, Eigen::MatrixXd, Eigen::MatrixXd, Eigen::MatrixXd&gt;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno"><a class="line" href="mnist_8cpp.html#a1f2262a3dab42b2363290168ef6d8337">  222</a></span><a class="code hl_function" href="mnist_8cpp.html#a1f2262a3dab42b2363290168ef6d8337">fetch_mnist</a>(<span class="keyword">const</span> std::string &amp;data_dir)</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>{</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    <span class="keyword">const</span> std::string train_images_url = <a class="code hl_variable" href="mnist_8cpp.html#a090e85bf3b44a471480e17b14f33ccca">BASE_URL</a> + <span class="stringliteral">&quot;train-images-idx3-ubyte.gz&quot;</span>;</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <span class="keyword">const</span> std::string train_images_path = data_dir + <span class="stringliteral">&quot;/train-images-idx3-ubyte.gz&quot;</span>;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <span class="keyword">const</span> std::string train_images_file = data_dir + <span class="stringliteral">&quot;/train-images-idx3-ubyte&quot;</span>;</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <span class="keyword">const</span> std::string train_labels_url = <a class="code hl_variable" href="mnist_8cpp.html#a090e85bf3b44a471480e17b14f33ccca">BASE_URL</a> + <span class="stringliteral">&quot;train-labels-idx1-ubyte.gz&quot;</span>;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    <span class="keyword">const</span> std::string train_labels_path = data_dir + <span class="stringliteral">&quot;/train-labels-idx1-ubyte.gz&quot;</span>;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    <span class="keyword">const</span> std::string train_labels_file = data_dir + <span class="stringliteral">&quot;/train-labels-idx1-ubyte&quot;</span>;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    <span class="keyword">const</span> std::string test_images_url = <a class="code hl_variable" href="mnist_8cpp.html#a090e85bf3b44a471480e17b14f33ccca">BASE_URL</a> + <span class="stringliteral">&quot;t10k-images-idx3-ubyte.gz&quot;</span>;</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    <span class="keyword">const</span> std::string test_images_path = data_dir + <span class="stringliteral">&quot;/t10k-images-idx3-ubyte.gz&quot;</span>;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    <span class="keyword">const</span> std::string test_images_file = data_dir + <span class="stringliteral">&quot;/t10k-images-idx3-ubyte&quot;</span>;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    <span class="keyword">const</span> std::string test_labels_url = <a class="code hl_variable" href="mnist_8cpp.html#a090e85bf3b44a471480e17b14f33ccca">BASE_URL</a> + <span class="stringliteral">&quot;t10k-labels-idx1-ubyte.gz&quot;</span>;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <span class="keyword">const</span> std::string test_labels_path = data_dir + <span class="stringliteral">&quot;/t10k-labels-idx1-ubyte.gz&quot;</span>;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    <span class="keyword">const</span> std::string test_labels_file = data_dir + <span class="stringliteral">&quot;/t10k-labels-idx1-ubyte&quot;</span>;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span> </div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    <span class="keywordflow">if</span> (!std::filesystem::exists(train_images_file) ||</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        !std::filesystem::exists(train_labels_file) ||</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>        !std::filesystem::exists(test_images_file) ||</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>        !std::filesystem::exists(test_labels_file))</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    {</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>        std::filesystem::create_directories(data_dir);</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span> </div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Downloading MNIST training images...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>        <a class="code hl_function" href="mnist_8cpp.html#a7c63282ad68df1a95e0403260865011c">download_file</a>(train_images_url, train_images_path);</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Downloading MNIST training labels...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        <a class="code hl_function" href="mnist_8cpp.html#a7c63282ad68df1a95e0403260865011c">download_file</a>(train_labels_url, train_labels_path);</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Downloading MNIST test images...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>        <a class="code hl_function" href="mnist_8cpp.html#a7c63282ad68df1a95e0403260865011c">download_file</a>(test_images_url, test_images_path);</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span> </div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Downloading MNIST test labels...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>        <a class="code hl_function" href="mnist_8cpp.html#a7c63282ad68df1a95e0403260865011c">download_file</a>(test_labels_url, test_labels_path);</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Extracting MNIST training images...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>        <a class="code hl_function" href="mnist_8cpp.html#a0cff9e7b5af8c9ddca0cad993e41f7a2">unzip_file</a>(train_images_path, train_images_file);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Extracting MNIST training labels...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>        <a class="code hl_function" href="mnist_8cpp.html#a0cff9e7b5af8c9ddca0cad993e41f7a2">unzip_file</a>(train_labels_path, train_labels_file);</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span> </div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Extracting MNIST test images...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>        <a class="code hl_function" href="mnist_8cpp.html#a0cff9e7b5af8c9ddca0cad993e41f7a2">unzip_file</a>(test_images_path, test_images_file);</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span> </div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Extracting MNIST test labels...&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        <a class="code hl_function" href="mnist_8cpp.html#a0cff9e7b5af8c9ddca0cad993e41f7a2">unzip_file</a>(test_labels_path, test_labels_file);</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    }</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    Eigen::MatrixXd x_train = <a class="code hl_function" href="mnist_8cpp.html#a1491b509fa59f2feb172a47697453bf9">read_mnist_images</a>(train_images_file);</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    Eigen::MatrixXd y_train = <a class="code hl_function" href="mnist_8cpp.html#a17d523ce09d4ae1a3b498017aa857a9d">read_mnist_labels</a>(train_labels_file);</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    Eigen::MatrixXd x_test = <a class="code hl_function" href="mnist_8cpp.html#a1491b509fa59f2feb172a47697453bf9">read_mnist_images</a>(test_images_file);</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    Eigen::MatrixXd y_test = <a class="code hl_function" href="mnist_8cpp.html#a17d523ce09d4ae1a3b498017aa857a9d">read_mnist_labels</a>(test_labels_file);</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span> </div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <span class="keywordflow">return</span> std::make_tuple(x_train, y_train, x_test, y_test);</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>};</div>
<div class="ttc" id="amnist_8cpp_html_a090e85bf3b44a471480e17b14f33ccca"><div class="ttname"><a href="mnist_8cpp.html#a090e85bf3b44a471480e17b14f33ccca">BASE_URL</a></div><div class="ttdeci">const std::string BASE_URL</div><div class="ttdef"><b>Definition</b> mnist.cpp:20</div></div>
<div class="ttc" id="amnist_8cpp_html_a0cff9e7b5af8c9ddca0cad993e41f7a2"><div class="ttname"><a href="mnist_8cpp.html#a0cff9e7b5af8c9ddca0cad993e41f7a2">unzip_file</a></div><div class="ttdeci">bool unzip_file(const std::string &amp;gz_path, const std::string &amp;out_path)</div><div class="ttdoc">Unzip gz file and save to local path.</div><div class="ttdef"><b>Definition</b> mnist.cpp:93</div></div>
<div class="ttc" id="amnist_8cpp_html_a1491b509fa59f2feb172a47697453bf9"><div class="ttname"><a href="mnist_8cpp.html#a1491b509fa59f2feb172a47697453bf9">read_mnist_images</a></div><div class="ttdeci">Eigen::MatrixXd read_mnist_images(const std::string &amp;filename)</div><div class="ttdoc">Read a MNIST image file.</div><div class="ttdef"><b>Definition</b> mnist.cpp:128</div></div>
<div class="ttc" id="amnist_8cpp_html_a17d523ce09d4ae1a3b498017aa857a9d"><div class="ttname"><a href="mnist_8cpp.html#a17d523ce09d4ae1a3b498017aa857a9d">read_mnist_labels</a></div><div class="ttdeci">Eigen::MatrixXd read_mnist_labels(const std::string &amp;filename)</div><div class="ttdoc">Read a MNIST label file.</div><div class="ttdef"><b>Definition</b> mnist.cpp:179</div></div>
<div class="ttc" id="amnist_8cpp_html_a1f2262a3dab42b2363290168ef6d8337"><div class="ttname"><a href="mnist_8cpp.html#a1f2262a3dab42b2363290168ef6d8337">fetch_mnist</a></div><div class="ttdeci">std::tuple&lt; Eigen::MatrixXd, Eigen::MatrixXd, Eigen::MatrixXd, Eigen::MatrixXd &gt; fetch_mnist(const std::string &amp;data_dir)</div><div class="ttdoc">Fetch MNIST dataset and save to local directory if it doesn't exist.</div><div class="ttdef"><b>Definition</b> mnist.cpp:222</div></div>
<div class="ttc" id="amnist_8cpp_html_a7c63282ad68df1a95e0403260865011c"><div class="ttname"><a href="mnist_8cpp.html#a7c63282ad68df1a95e0403260865011c">download_file</a></div><div class="ttdeci">void download_file(const std::string &amp;url, const std::string &amp;path)</div><div class="ttdoc">Download file from URL and save to local path.</div><div class="ttdef"><b>Definition</b> mnist.cpp:44</div></div>
<div class="ttc" id="amnist_8cpp_html_acde73c899ec0618eeb8ae54b0a823f39"><div class="ttname"><a href="mnist_8cpp.html#acde73c899ec0618eeb8ae54b0a823f39">file_exists</a></div><div class="ttdeci">bool file_exists(const std::string &amp;filename)</div><div class="ttdoc">Check if file exists.</div><div class="ttdef"><b>Definition</b> mnist.cpp:27</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_4eeb864c4eec08c7d6b9d3b0352cfdde.html">tools</a></li><li class="navelem"><a class="el" href="mnist_8cpp.html">mnist.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
