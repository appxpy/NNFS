<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Doxygen Awesome" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<meta property="og:url" content="https://jothepro.github.io/doxygen-awesome-css/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta name="twitter:title" content="Doxygen Awesome" />
<meta name="twitter:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<!-- END twitter metadata -->
<title>NNFS: include/NNFS/Model/NeuralNetwork.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/appxpy/NNFS" class="github-corner" title="View source on GitHub" target="_blank">
    <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <svg width="44" height="44" viewBox="0 0 48 49" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect width="48" height="48" transform="translate(0 0.219971)" fill="var(--page-foreground-color)"/>
        <path d="M13.44 23.22V10.62H15.186L20.856 20.484V10.62H22.422V23.22H20.694L15.024 13.356V23.22H13.44ZM25.3052 23.22V10.62H27.0512L32.7212 20.484V10.62H34.2872V23.22H32.5592L26.8892 13.356V23.22H25.3052ZM13.44 37.22V24.62H20.604V26.096H15.078V30.65H20.604V32.126H15.078V37.22H13.44ZM30.3156 37.508C28.8876 37.508 27.7716 37.13 26.9676 36.374C26.1636 35.618 25.7616 34.562 25.7616 33.206H27.3996C27.3996 34.082 27.6576 34.778 28.1736 35.294C28.7016 35.81 29.4096 36.068 30.2976 36.068C31.0896 36.068 31.7016 35.888 32.1336 35.528C32.5656 35.156 32.7816 34.64 32.7816 33.98C32.7816 33.428 32.6256 32.984 32.3136 32.648C32.0136 32.312 31.4976 32.018 30.7656 31.766L28.6776 31.028C26.9856 30.488 26.1396 29.384 26.1396 27.716C26.1396 26.708 26.5056 25.892 27.2376 25.268C27.9696 24.644 28.9236 24.332 30.0996 24.332C31.3356 24.332 32.3256 24.68 33.0696 25.376C33.8136 26.072 34.1856 27.008 34.1856 28.184H32.5476C32.5476 27.404 32.3316 26.804 31.8996 26.384C31.4676 25.952 30.8496 25.736 30.0456 25.736C29.3496 25.736 28.7976 25.91 28.3896 26.258C27.9936 26.594 27.7956 27.05 27.7956 27.626C27.7956 28.154 27.9696 28.592 28.3176 28.94C28.6656 29.288 29.2296 29.594 30.0096 29.858L31.9536 30.542C33.6096 31.13 34.4376 32.264 34.4376 33.944C34.4376 35.012 34.0596 35.876 33.3036 36.536C32.5596 37.184 31.5636 37.508 30.3156 37.508Z" fill="var(--page-background-color)"/>
    </svg>
  </td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NNFS
   </div>
   <div id="projectbrief">Neural network library from scratch</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_neural_network_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">NeuralNetwork.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="_neural_network_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#pragma once</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span> </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &lt;tuple&gt;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &quot;<a class="code" href="_model_8hpp.html">Model.hpp</a>&quot;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &quot;../Layer/Layer.hpp&quot;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &quot;../Layer/Dense.hpp&quot;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &quot;../Activation/Activation.hpp&quot;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &quot;../Activation/ReLU.hpp&quot;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &quot;../Activation/Sigmoid.hpp&quot;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &quot;../Activation/Tanh.hpp&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &quot;../Activation/Softmax.hpp&quot;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &quot;../Loss/Loss.hpp&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &quot;../Loss/CCE_Softmax.hpp&quot;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &quot;../Metrics/Metrics.hpp&quot;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;../Optimizer/Optimizer.hpp&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_n_n_f_s.html">NNFS</a></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>{</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno"><a class="line" href="class_n_n_f_s_1_1_neural_network.html">   36</a></span>    <span class="keyword">class </span><a class="code hl_class" href="class_n_n_f_s_1_1_neural_network.html">NeuralNetwork</a> : <span class="keyword">public</span> <a class="code hl_class" href="class_n_n_f_s_1_1_model.html">Model</a></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>    {</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>    <span class="keyword">public</span>:</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno"><a class="line" href="class_n_n_f_s_1_1_neural_network.html#acde2d16b041d2c1baf3e0db7fe05e627">   45</a></span>        <a class="code hl_function" href="class_n_n_f_s_1_1_neural_network.html#acde2d16b041d2c1baf3e0db7fe05e627">NeuralNetwork</a>(</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>            std::shared_ptr&lt;Loss&gt; loss = <span class="keyword">nullptr</span>, std::shared_ptr&lt;Optimizer&gt; optimizer = <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>            : loss_object(loss),</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>              optimizer_object(optimizer),</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>              num_layers(0) {}</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno"><a class="line" href="class_n_n_f_s_1_1_neural_network.html#aeba8854f57061e4669ecfa09831c86b6">   64</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_n_n_f_s_1_1_neural_network.html#aeba8854f57061e4669ecfa09831c86b6">fit</a>(<span class="keyword">const</span> Eigen::MatrixXd &amp;examples,</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>                 <span class="keyword">const</span> Eigen::MatrixXd &amp;labels,</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>                 <span class="keyword">const</span> Eigen::MatrixXd &amp;test_examples,</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>                 <span class="keyword">const</span> Eigen::MatrixXd &amp;test_labels,</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>                 <span class="keywordtype">int</span> epochs,</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>                 <span class="keywordtype">int</span> batch_size,</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>                 <span class="keywordtype">bool</span> verbose = <span class="keyword">true</span>)<span class="keyword"> override</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>            <span class="keywordflow">if</span> (loss_object == <span class="keyword">nullptr</span> || optimizer_object == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>            {</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>                <a class="code hl_define" href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>(<span class="stringliteral">&quot;Training is not possible for this neural network object as the loss and optimizer have not been specified.&quot;</span>);</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>            }</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>            <span class="keywordflow">if</span> (!compiled)</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>            {</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>                <a class="code hl_define" href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>(<span class="stringliteral">&quot;Please compile the neural network object before attempting to train it.&quot;</span>);</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>            }</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>            <span class="keywordflow">if</span> (examples.cols() != input_dim || test_examples.cols() != input_dim)</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>            {</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>                <a class="code hl_define" href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>(<span class="stringliteral">&quot;The number of columns in the examples matrix must match the input dimension of the neural network.&quot;</span>);</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>            }</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>            <span class="keywordflow">if</span> (labels.cols() != output_dim || test_labels.cols() != output_dim)</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>            {</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>                <a class="code hl_define" href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>(<span class="stringliteral">&quot;The number of columns in the labels matrix must match the output dimension of the neural network.&quot;</span>);</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>            }</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>            <span class="keywordtype">int</span> num_examples = examples.rows();</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>            <span class="keywordtype">int</span> num_batches = num_examples / batch_size;</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>            <span class="keywordtype">int</span> batches_num_length = std::to_string(num_batches).length();</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span> </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> epoch = 1; epoch &lt;= epochs; ++epoch)</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>            {</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;Epoch &quot;</span> &lt;&lt; epoch &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; epochs &lt;&lt; std::endl;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>                <span class="keywordtype">double</span> total_loss = 0;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>                <span class="keywordtype">double</span> total_data_loss = 0;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>                <span class="keywordtype">double</span> total_reg_loss = 0;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                <span class="keywordtype">int</span> batch_time_total = 0;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>                <span class="keyword">auto</span> time_start = std::chrono::high_resolution_clock::now();</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_batches; ++i)</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>                {</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                    <span class="keyword">auto</span> batch_time_start = std::chrono::high_resolution_clock::now();</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>                    <span class="keywordtype">double</span> batch_loss = 0;</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>                    <span class="keywordtype">double</span> data_loss = 0;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>                    <span class="keywordtype">double</span> reg_loss = 0;</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>                    <span class="keywordtype">int</span> start = i * batch_size;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>                    <span class="keywordtype">int</span> end = std::min(start + batch_size, num_examples);</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>                    Eigen::MatrixXd batch_examples = examples.middleRows(start, end - start);</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>                    Eigen::MatrixXd batch_labels = labels.middleRows(start, end - start);</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>                    forward(batch_examples);</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span> </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>                    loss_object-&gt;calculate(data_loss, batch_examples, batch_labels);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>                    regularization_loss(reg_loss);</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span> </div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>                    optimizer_object-&gt;pre_update_params();</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>                    backward(batch_examples, batch_labels);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>                    optimizer_object-&gt;post_update_params();</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>                    <span class="keywordflow">if</span> (verbose)</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>                    {</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                        batch_loss = data_loss + reg_loss;</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>                        total_loss += batch_loss;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>                        total_data_loss += data_loss;</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>                        total_reg_loss += reg_loss;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span> </div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; std::setw(batches_num_length) &lt;&lt; i + 1;</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>                        std::cout &lt;&lt; <span class="charliteral">&#39;/&#39;</span> &lt;&lt; num_batches;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>                        progressbar(num_batches, i, 50);</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>                        <span class="keyword">auto</span> batch_time_end = std::chrono::high_resolution_clock::now();</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>                        <span class="keyword">auto</span> running = std::chrono::duration_cast&lt;std::chrono::seconds&gt;(batch_time_end - time_start);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>                        <span class="keyword">auto</span> batch_time = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(batch_time_end - batch_time_start);</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>                        batch_time_total += batch_time.count();</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span> </div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;- &quot;</span> &lt;&lt; std::setw(4) &lt;&lt; running.count();</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;s&quot;</span>;</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>                        <span class="keywordflow">if</span> (i + 1 != num_batches)</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>                        {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>                            std::cout &lt;&lt; <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>                            std::cout.flush();</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>                        }</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>                    }</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>                }</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>                <span class="keywordflow">if</span> (verbose)</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>                {</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>                    <span class="keywordtype">double</span> train_accuracy = 0;</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>                    <span class="keywordtype">double</span> test_accuracy = 0;</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>                    <a class="code hl_function" href="class_n_n_f_s_1_1_neural_network.html#a7337c868ff69d0f6692cdaf09f140896">accuracy</a>(train_accuracy, examples, labels);</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>                    <a class="code hl_function" href="class_n_n_f_s_1_1_neural_network.html#a7337c868ff69d0f6692cdaf09f140896">accuracy</a>(test_accuracy, test_examples, test_labels);</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>                    batch_time_total /= num_batches;</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>                    total_loss /= num_batches;</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>                    total_data_loss /= num_batches;</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                    total_reg_loss /= num_batches;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>                    <span class="keywordtype">double</span> current_lr = optimizer_object-&gt;current_lr();</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; batch_time_total &lt;&lt; <span class="stringliteral">&quot;ms/batch&quot;</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>                              &lt;&lt; <span class="stringliteral">&quot; - loss: &quot;</span> &lt;&lt; std::fixed &lt;&lt; std::setprecision(3) &lt;&lt; total_loss</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>                              &lt;&lt; <span class="stringliteral">&quot; ( data: &quot;</span> &lt;&lt; total_data_loss &lt;&lt; <span class="stringliteral">&quot;, reg: &quot;</span> &lt;&lt; total_reg_loss</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>                              &lt;&lt; <span class="stringliteral">&quot; ) - train_accuracy: &quot;</span> &lt;&lt; train_accuracy &lt;&lt; <span class="stringliteral">&quot; - test_accuracy: &quot;</span> &lt;&lt; test_accuracy</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>                              &lt;&lt; <span class="stringliteral">&quot; - lr: &quot;</span> &lt;&lt; current_lr</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>                              &lt;&lt; std::endl;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>                }</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>            }</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>        }</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno"><a class="line" href="class_n_n_f_s_1_1_neural_network.html#a5a7d8ad56a8a645f3c80dda9a439cf31">  197</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_n_n_f_s_1_1_neural_network.html#a5a7d8ad56a8a645f3c80dda9a439cf31">add_layer</a>(std::shared_ptr&lt;Layer&gt; layer)</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        {</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>            layers.push_back(layer);</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>            num_layers = layers.size();</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        }</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno"><a class="line" href="class_n_n_f_s_1_1_neural_network.html#a097aea27a1656c01264970b7c5e1883e">  208</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_n_n_f_s_1_1_neural_network.html#a097aea27a1656c01264970b7c5e1883e">compile</a>()</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        {</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>            compiled = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>            input_dim = -1;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>            output_dim = -1;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>            <span class="keywordflow">if</span> (num_layers == 0)</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>            {</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>                <a class="code hl_define" href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>(<span class="stringliteral">&quot;Please add at least one layer to your neural network using the NNFS::add_layer method before compiling to ensure proper model functionality.&quot;</span>);</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>            }</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span> </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>            <a class="code hl_enumeration" href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddf">LayerType</a> prev_type;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>            <span class="keywordtype">int</span> prev_out = -1;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_layers; i++)</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>            {</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>                std::shared_ptr&lt;Layer&gt; cur_layer = layers[i];</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>                <a class="code hl_enumeration" href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddf">LayerType</a> cur_type = cur_layer-&gt;type;</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span> </div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>                <span class="keywordflow">if</span> (cur_type == <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddfaa62e9496bde05da2a14255d4a533bab9">LayerType::ACTIVATION</a>)</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>                {</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>                    <span class="keywordflow">if</span> (i == 0)</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>                    {</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>                        <a class="code hl_define" href="clue_8hpp.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>(<span class="stringliteral">&quot;Applying an activation function as the first layer of a neural network can distort or lose important information in the input data. It is recommended to use a dense layer for input processing followed by activation functions in subsequent layers to preserve the integrity of the input data.&quot;</span>);</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>                    }</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (prev_type == cur_type)</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>                    {</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>                        <a class="code hl_define" href="clue_8hpp.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>(<span class="stringliteral">&quot;Applying multiple activation functions in a row can cause issues with learning. Consider using a different layer type or adjusting your model architecture.&quot;</span>);</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>                    }</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>                }</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cur_type == <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddfa0706fbbd929bd8abc4de386c53d439ff">LayerType::DENSE</a>)</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>                {</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>                    std::shared_ptr&lt;Dense&gt; dense_layer = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>std::shared_ptr&lt;Dense&gt; &amp;<span class="keyword">&gt;</span>(layers[i]);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>                    <span class="keywordtype">int</span> cur_input;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>                    <span class="keywordtype">int</span> cur_output;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span> </div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>                    dense_layer-&gt;shape(cur_input, cur_output);</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span> </div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>                    <span class="keywordflow">if</span> (prev_out != -1 &amp;&amp; cur_input != prev_out)</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>                    {</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>                        <a class="code hl_define" href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>(<span class="stringliteral">&quot;Shape mismatch detected in NNFS::compile(). Previous dense layer output shape (&quot;</span> &lt;&lt; prev_out &lt;&lt; <span class="stringliteral">&quot;) does not match current dense layer input shape (&quot;</span> &lt;&lt; cur_input &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>);</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>                        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>                    }</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span> </div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>                    prev_out = cur_output;</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>                }</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>                {</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>                    <a class="code hl_define" href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>(<span class="stringliteral">&quot;Unknown layer type detected in NNFS::compile(). Please ensure that all layers in your neural network have a valid layer type and that the NNFS library supports the specified type.&quot;</span>);</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>                }</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span> </div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>                prev_type = cur_type;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>            }</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span> </div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_layers; i++)</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>            {</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>                std::shared_ptr&lt;Layer&gt; cur_layer = layers[i];</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>                <a class="code hl_enumeration" href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddf">LayerType</a> cur_type = cur_layer-&gt;type;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>                <span class="keywordflow">if</span> (cur_type == <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddfa0706fbbd929bd8abc4de386c53d439ff">LayerType::DENSE</a>)</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>                {</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>                    std::shared_ptr&lt;Dense&gt; dense_layer = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>std::shared_ptr&lt;Dense&gt; &amp;<span class="keyword">&gt;</span>(layers[i]);</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span> </div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>                    <span class="keywordtype">int</span> cur_input;</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>                    <span class="keywordtype">int</span> cur_output;</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>                    dense_layer-&gt;shape(cur_input, cur_output);</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span> </div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>                    <span class="keywordflow">if</span> (input_dim == -1)</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>                    {</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>                        input_dim = cur_input;</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>                    }</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>                    output_dim = cur_output;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>                }</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>            }</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span> </div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>            compiled = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>        }</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span> </div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno"><a class="line" href="class_n_n_f_s_1_1_neural_network.html#a8c299a82e81448a966919872973c2c28">  296</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_n_n_f_s_1_1_neural_network.html#a8c299a82e81448a966919872973c2c28">save</a>(std::string path)</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        {</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>            <span class="comment">// Create ofstream object</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>            std::ofstream ofs(path, std::ios::binary);</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span> </div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>            <span class="comment">// Write number of layers</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>            ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;num_layers), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_layers; i++)</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>            {</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>                std::shared_ptr&lt;Layer&gt; layer = layers[i];</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>                <span class="keywordflow">if</span> (layer-&gt;type == <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddfa0706fbbd929bd8abc4de386c53d439ff">LayerType::DENSE</a>)</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>                {</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>                    std::shared_ptr&lt;Dense&gt; dense_layer = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>std::shared_ptr&lt;Dense&gt; &amp;<span class="keyword">&gt;</span>(layers[i]);</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span> </div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>                    <span class="comment">// Schema for dense layer</span></div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>                    <span class="comment">// - int type</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>                    <span class="comment">// - int n_input</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>                    <span class="comment">// - int n_output</span></div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>                    <span class="comment">// - Eigen::MatrixXd weights</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>                    <span class="comment">// - Eigen::MatrixXd biases</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>                    <span class="comment">// - double l1_weight_regularizer</span></div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>                    <span class="comment">// - double l2_weight_regularizer</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>                    <span class="comment">// - double l1_bias_regularizer</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>                    <span class="comment">// - double l2_bias_regularizer</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>                    <span class="comment">// - Eigen::MatrixXd weights_optimizer</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>                    <span class="comment">// - Eigen::MatrixXd biases_optimizer</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>                    <span class="comment">// - Eigen::MatrixXd weights_optimizer_additional</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>                    <span class="comment">// - Eigen::MatrixXd biases_optimizer_additional</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span> </div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>                    <span class="keywordtype">int</span> type = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(layer-&gt;type);</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>                    <span class="keywordtype">int</span> n_input;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>                    <span class="keywordtype">int</span> n_output;</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>                    dense_layer-&gt;shape(n_input, n_output);</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span> </div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>                    Eigen::MatrixXd weights = dense_layer-&gt;weights();</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>                    Eigen::MatrixXd biases = dense_layer-&gt;biases();</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>                    <span class="keywordtype">double</span> l1_weight_regularizer = dense_layer-&gt;l1_weights_regularizer();</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>                    <span class="keywordtype">double</span> l2_weight_regularizer = dense_layer-&gt;l2_weights_regularizer();</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>                    <span class="keywordtype">double</span> l1_bias_regularizer = dense_layer-&gt;l1_biases_regularizer();</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>                    <span class="keywordtype">double</span> l2_bias_regularizer = dense_layer-&gt;l2_biases_regularizer();</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span> </div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>                    Eigen::MatrixXd weights_optimizer = dense_layer-&gt;weights_optimizer();</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>                    Eigen::MatrixXd biases_optimizer = dense_layer-&gt;biases_optimizer();</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span> </div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>                    Eigen::MatrixXd weights_optimizer_additional = dense_layer-&gt;weights_optimizer_additional();</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>                    Eigen::MatrixXd biases_optimizer_additional = dense_layer-&gt;biases_optimizer_additional();</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span> </div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>                    <span class="comment">// Write schema to file</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;type), <span class="keyword">sizeof</span>(type));</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;n_input), <span class="keyword">sizeof</span>(n_input));</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;n_output), <span class="keyword">sizeof</span>(n_output));</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span> </div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(weights.data()), weights.size() * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(biases.data()), biases.size() * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span> </div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;l1_weight_regularizer), <span class="keyword">sizeof</span>(double));</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;l2_weight_regularizer), <span class="keyword">sizeof</span>(double));</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;l1_bias_regularizer), <span class="keyword">sizeof</span>(double));</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;l2_bias_regularizer), <span class="keyword">sizeof</span>(double));</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span> </div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(weights_optimizer.data()), weights_optimizer.size() * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(biases_optimizer.data()), biases_optimizer.size() * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(weights_optimizer_additional.data()), weights_optimizer_additional.size() * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(biases_optimizer_additional.data()), biases_optimizer_additional.size() * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>                }</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (layer-&gt;type == <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddfaa62e9496bde05da2a14255d4a533bab9">LayerType::ACTIVATION</a>)</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>                {</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>                    std::shared_ptr&lt;Activation&gt; activation_layer = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>std::shared_ptr&lt;Activation&gt; &amp;<span class="keyword">&gt;</span>(layers[i]);</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span> </div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>                    <span class="comment">// Schema for activation layer</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>                    <span class="comment">// - int type</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>                    <span class="comment">// - int activation_type</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>                    <span class="keywordtype">int</span> type = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(layer-&gt;type);</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>                    <span class="keywordtype">int</span> activation_type = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(activation_layer-&gt;activation_type);</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span> </div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>                    <span class="comment">// Write schema to file</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;type), <span class="keyword">sizeof</span>(type));</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>                    ofs.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;activation_type), <span class="keyword">sizeof</span>(activation_type));</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>                }</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>                {</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>                    <a class="code hl_define" href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>(<span class="stringliteral">&quot;Unknown layer type detected in NNFS::save(). Please ensure that all layers in your neural network have a valid layer type and that the NNFS library supports the specified type.&quot;</span>);</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>                    ofs.close();</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>                    std::remove(path.c_str());</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>                }</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>            }</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>        }</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno"><a class="line" href="class_n_n_f_s_1_1_neural_network.html#a751e0643136468b84a5beeb8ab7fd9c7">  394</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_n_n_f_s_1_1_neural_network.html#a751e0643136468b84a5beeb8ab7fd9c7">load</a>(std::string path)</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>        {</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>            <span class="comment">// Create ifstream object</span></div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>            std::ifstream ifs(path, std::ios::binary);</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span> </div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>            <span class="comment">// Check if file exists</span></div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>            <span class="keywordflow">if</span> (!ifs.good())</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>            {</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>                <a class="code hl_define" href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>(<span class="stringliteral">&quot;File does not exist in NNFS::load(). Please ensure that the specified file exists.&quot;</span>);</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>            }</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span> </div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>            <span class="comment">// Clear layers</span></div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>            layers.clear();</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span> </div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>            <span class="comment">// Read number of layers</span></div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>            ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;num_layers), <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>            <span class="comment">// Read layers</span></div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_layers; i++)</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>            {</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>                <span class="comment">// Read layer type</span></div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>                <span class="keywordtype">int</span> type;</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>                ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;type), <span class="keyword">sizeof</span>(type));</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span> </div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>                <span class="keywordflow">if</span> (type == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_enumvalue" href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddfa0706fbbd929bd8abc4de386c53d439ff">LayerType::DENSE</a>))</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>                {</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>                    <span class="comment">// Read layer shape</span></div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>                    <span class="keywordtype">int</span> n_input;</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>                    <span class="keywordtype">int</span> n_output;</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>                    ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;n_input), <span class="keyword">sizeof</span>(n_input));</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>                    ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;n_output), <span class="keyword">sizeof</span>(n_output));</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span> </div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>                    <span class="comment">// Read weights and biases</span></div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>                    Eigen::MatrixXd weights(n_input, n_output);</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>                    Eigen::MatrixXd biases(1, n_output);</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>                    ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(weights.data()), weights.size() * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>                    ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(biases.data()), biases.size() * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> </div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>                    <span class="comment">// Read regularizers</span></div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>                    <span class="keywordtype">double</span> l1_weight_regularizer;</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>                    <span class="keywordtype">double</span> l2_weight_regularizer;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>                    <span class="keywordtype">double</span> l1_bias_regularizer;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>                    <span class="keywordtype">double</span> l2_bias_regularizer;</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>                    ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;l1_weight_regularizer), <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>                    ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;l2_weight_regularizer), <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>                    ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;l1_bias_regularizer), <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>                    ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;l2_bias_regularizer), <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>                    <span class="comment">// Create dense layer</span></div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>                    std::shared_ptr&lt;Dense&gt; dense_layer = std::make_shared&lt;Dense&gt;(n_input, n_output, l1_weight_regularizer, l2_weight_regularizer, l1_bias_regularizer, l2_bias_regularizer);</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span> </div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>                    <span class="comment">// Read optimizers</span></div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>                    Eigen::MatrixXd weights_optimizer(n_input, n_output);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>                    Eigen::MatrixXd biases_optimizer(1, n_output);</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>                    Eigen::MatrixXd weights_optimizer_additional(n_input, n_output);</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>                    Eigen::MatrixXd biases_optimizer_additional(1, n_output);</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>                    ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(weights_optimizer.data()), weights_optimizer.size() * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>                    ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(biases_optimizer.data()), biases_optimizer.size() * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>                    ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(weights_optimizer_additional.data()), weights_optimizer_additional.size() * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>                    ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(biases_optimizer_additional.data()), biases_optimizer_additional.size() * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>                    <span class="comment">// Resize all matrices</span></div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>                    weights.resize(n_input, n_output);</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>                    biases.resize(1, n_output);</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>                    weights_optimizer.resize(n_input, n_output);</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>                    biases_optimizer.resize(1, n_output);</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>                    weights_optimizer_additional.resize(n_input, n_output);</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>                    biases_optimizer_additional.resize(1, n_output);</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span> </div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>                    <span class="comment">// Set weights and biases</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>                    dense_layer-&gt;weights(weights);</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>                    dense_layer-&gt;biases(biases);</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>                    dense_layer-&gt;weights_optimizer(weights_optimizer);</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>                    dense_layer-&gt;biases_optimizer(biases_optimizer);</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>                    dense_layer-&gt;weights_optimizer_additional(weights_optimizer_additional);</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>                    dense_layer-&gt;biases_optimizer_additional(biases_optimizer_additional);</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span> </div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>                    <span class="comment">// Add dense layer to layers</span></div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>                    layers.push_back(dense_layer);</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>                }</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code hl_enumvalue" href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddfaa62e9496bde05da2a14255d4a533bab9">LayerType::ACTIVATION</a>))</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>                {</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>                    <span class="comment">// Read activation type</span></div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>                    <span class="keywordtype">int</span> activation_type;</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>                    ifs.read(<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(&amp;activation_type), <span class="keyword">sizeof</span>(activation_type));</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>                    <span class="comment">// Convert activation type to enum</span></div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>                    <a class="code hl_enumeration" href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407">ActivationType</a> activation;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>                    <span class="keywordflow">switch</span> (activation_type)</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>                    {</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>                    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>                        activation = <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407ad346bb4679d29be241279f15d7795c1c">ActivationType::RELU</a>;</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>                    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>                        activation = <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407ab299f45b5de2a8f7c45192590290742b">ActivationType::SIGMOID</a>;</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>                    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>                        activation = <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407a143c8c6f51b9bb893ce71e38702e3cc1">ActivationType::TANH</a>;</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>                    <span class="keywordflow">case</span> 3:</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>                        activation = <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407a1d993169621e0855bad00d71c005cf1b">ActivationType::SOFTMAX</a>;</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>                    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>                        activation = <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407ab50339a10e1de285ac99d4c3990b8693">ActivationType::NONE</a>;</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>                    }</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span> </div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>                    <span class="keywordflow">if</span> (activation == <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407ab50339a10e1de285ac99d4c3990b8693">ActivationType::NONE</a>)</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>                    {</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>                        <a class="code hl_define" href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>(<span class="stringliteral">&quot;Unknown activation type detected in NNFS::load(). Please ensure that all layers in your neural network have a valid activation type and that the NNFS library supports the specified type.&quot;</span>);</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>                        ifs.close();</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>                        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>                    }</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span> </div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>                    <span class="comment">// Create activation layer according to activation type, e.g std::make_shared&lt;ReLU&gt;() or std::make_shared&lt;Sigmoid&gt;() etc.;</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>                    std::shared_ptr&lt;Activation&gt; activation_layer;</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>                    <span class="keywordflow">switch</span> (activation)</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>                    {</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>                    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407ab299f45b5de2a8f7c45192590290742b">ActivationType::SIGMOID</a>:</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>                        activation_layer = std::make_shared&lt;Sigmoid&gt;();</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>                    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407a143c8c6f51b9bb893ce71e38702e3cc1">ActivationType::TANH</a>:</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>                        activation_layer = std::make_shared&lt;Tanh&gt;();</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>                    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407a1d993169621e0855bad00d71c005cf1b">ActivationType::SOFTMAX</a>:</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>                        activation_layer = std::make_shared&lt;Softmax&gt;();</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>                    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>                        activation_layer = std::make_shared&lt;ReLU&gt;();</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>                    }</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span> </div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>                    <span class="comment">// Add activation layer to layers</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>                    layers.push_back(activation_layer);</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>                }</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>                {</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>                    <a class="code hl_define" href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>(<span class="stringliteral">&quot;Unknown layer type detected in NNFS::load(). Please ensure that all layers in your neural network have a valid layer type and that the NNFS library supports the specified type.&quot;</span>);</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>                    ifs.close();</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>                }</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>            }</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span> </div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>            <span class="comment">// If everything went well, close the file</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>            ifs.close();</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span> </div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>            <span class="comment">// Compile the neural network</span></div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>            <a class="code hl_function" href="class_n_n_f_s_1_1_neural_network.html#a097aea27a1656c01264970b7c5e1883e">compile</a>();</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>        }</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span> </div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno"><a class="line" href="class_n_n_f_s_1_1_neural_network.html#a7337c868ff69d0f6692cdaf09f140896">  552</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="class_n_n_f_s_1_1_neural_network.html#a7337c868ff69d0f6692cdaf09f140896">accuracy</a>(<span class="keywordtype">double</span> &amp;<a class="code hl_function" href="class_n_n_f_s_1_1_neural_network.html#a7337c868ff69d0f6692cdaf09f140896">accuracy</a>, <span class="keyword">const</span> Eigen::MatrixXd &amp;examples, <span class="keyword">const</span> Eigen::MatrixXd &amp;labels)</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>        {</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>            <span class="keywordflow">if</span> (examples.cols() != input_dim || labels.cols() != output_dim)</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>            {</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>                <a class="code hl_define" href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>(<span class="stringliteral">&quot;Input and output dimensions of the neural network do not match the dimensions of the provided samples and labels.&quot;</span>);</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>            }</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span> </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>            Eigen::MatrixXd predictions = examples;</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>            forward(predictions);</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>            <a class="code hl_function" href="class_n_n_f_s_1_1_metrics.html#ab688b3571cfe5261c39068a43b491f7a">Metrics::accuracy</a>(<a class="code hl_function" href="class_n_n_f_s_1_1_neural_network.html#a7337c868ff69d0f6692cdaf09f140896">accuracy</a>, predictions, labels);</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>        }</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span> </div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno"><a class="line" href="class_n_n_f_s_1_1_neural_network.html#a4e9b7be6f4e4309cc086ae631a48fa8f">  572</a></span>        Eigen::MatrixXd <a class="code hl_function" href="class_n_n_f_s_1_1_neural_network.html#a4e9b7be6f4e4309cc086ae631a48fa8f">predict</a>(<span class="keyword">const</span> Eigen::MatrixXd &amp;sample)</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        {</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>            <span class="keywordflow">if</span> (sample.cols() != input_dim)</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>            {</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>                <a class="code hl_define" href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>(<span class="stringliteral">&quot;Input dimension of the neural network does not match the dimension of the provided sample.&quot;</span>);</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>                <span class="keywordflow">return</span> Eigen::MatrixXd::Zero(sample.rows(), sample.cols());</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>            }</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span> </div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>            Eigen::MatrixXd prediction = sample;</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>            forward(prediction);</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span> </div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>            <span class="keywordflow">if</span> (layers[layers.size() - 1]-&gt;type != <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddfaa62e9496bde05da2a14255d4a533bab9">LayerType::ACTIVATION</a>) {</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>                <a class="code hl_class" href="class_n_n_f_s_1_1_softmax.html">Softmax</a> softmax = <a class="code hl_class" href="class_n_n_f_s_1_1_softmax.html">Softmax</a>();</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>                Eigen::MatrixXd prediction_softmax = prediction;</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>                softmax.<a class="code hl_function" href="class_n_n_f_s_1_1_softmax.html#acf0ead275399fc26f941d7dc521877c5">forward</a>(prediction_softmax, prediction);</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>                <span class="keywordflow">return</span> prediction_softmax;</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>            }</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span> </div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>            <span class="keywordflow">return</span> prediction;</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>        }</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span> </div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>    <span class="keyword">private</span>:</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        <span class="keywordtype">void</span> forward(Eigen::MatrixXd &amp;x)<span class="keyword"> override</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_layers; i++)</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>            {</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>                layers[i]-&gt;forward(x, x);</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>            }</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>        }</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span> </div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>        <span class="keywordtype">void</span> backward(Eigen::MatrixXd &amp;predicted, <span class="keyword">const</span> Eigen::MatrixXd &amp;labels)<span class="keyword"> override</span></div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span><span class="keyword">        </span>{</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>            Eigen::MatrixXd dx;</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>            loss_object-&gt;backward(dx, predicted, labels);</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span> </div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = num_layers - 1; i &gt;= 0; --i)</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>            {</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>                layers[i]-&gt;backward(dx, dx);</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>            }</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span> </div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_layers; i++)</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>            {</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>                <span class="keywordflow">if</span> (layers[i]-&gt;type == <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddfa0706fbbd929bd8abc4de386c53d439ff">LayerType::DENSE</a>)</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>                {</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>                    std::shared_ptr&lt;Dense&gt; _dense_layer = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>std::shared_ptr&lt;Dense&gt; &amp;<span class="keyword">&gt;</span>(layers[i]);</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span> </div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>                    optimizer_object-&gt;update_params(_dense_layer);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>                }</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>            }</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>        }</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span> </div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>        <span class="keywordtype">void</span> regularization_loss(<span class="keywordtype">double</span> &amp;loss)</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>        {</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_layers; i++)</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>            {</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>                <span class="keywordflow">if</span> (layers[i]-&gt;type == <a class="code hl_enumvalue" href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddfa0706fbbd929bd8abc4de386c53d439ff">LayerType::DENSE</a>)</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>                {</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>                    std::shared_ptr&lt;Dense&gt; _dense_layer = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>std::shared_ptr&lt;Dense&gt; &amp;<span class="keyword">&gt;</span>(layers[i]);</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>                    loss += loss_object-&gt;regularization_loss(_dense_layer);</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>                }</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>            }</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>        }</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span> </div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>        <span class="keywordtype">void</span> progressbar(<span class="keywordtype">int</span> total, <span class="keywordtype">int</span> current, <span class="keywordtype">int</span> length)</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>        {</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>            <span class="keywordtype">double</span> progress = (current + 1) / (<span class="keywordtype">double</span>)total;</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>            <span class="keywordtype">int</span> pos = length * progress;</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span> </div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>            std::cout &lt;&lt; <span class="stringliteral">&quot; [&quot;</span>;</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> current = 0; current &lt; length; ++current)</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>            {</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>                <span class="keywordflow">if</span> (current &lt; pos)</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>                {</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;=&quot;</span>;</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>                }</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current == pos)</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>                {</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span>;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>                }</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>                {</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>                }</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>            }</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span> </div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;] &quot;</span> &lt;&lt; std::setw(3) &lt;&lt; int(progress * 100);</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;% &quot;</span>;</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>        }</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span> </div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>        std::vector&lt;std::shared_ptr&lt;Layer&gt;&gt; layers;  <span class="comment">// Layers of the neural network</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>        std::shared_ptr&lt;Loss&gt; loss_object;           <span class="comment">// Loss function of the neural network</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>        std::shared_ptr&lt;Optimizer&gt; optimizer_object; <span class="comment">// Optimizer of the neural network</span></div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>        <span class="keywordtype">int</span> num_layers;                              <span class="comment">// Number of layers in the neural network</span></div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>        <span class="keywordtype">int</span> input_dim;                               <span class="comment">// Input dimension of the neural network</span></div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>        <span class="keywordtype">int</span> output_dim;                              <span class="comment">// Output dimension of the neural network</span></div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>        <span class="keywordtype">bool</span> compiled = <span class="keyword">false</span>;                       <span class="comment">// Indicates whether the neural network has been compiled</span></div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>    };</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span> </div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>} <span class="comment">// namespace NNFS</span></div>
<div class="ttc" id="a_model_8hpp_html"><div class="ttname"><a href="_model_8hpp.html">Model.hpp</a></div></div>
<div class="ttc" id="aclass_n_n_f_s_1_1_metrics_html_ab688b3571cfe5261c39068a43b491f7a"><div class="ttname"><a href="class_n_n_f_s_1_1_metrics.html#ab688b3571cfe5261c39068a43b491f7a">NNFS::Metrics::accuracy</a></div><div class="ttdeci">static void accuracy(double &amp;accuracy, const Eigen::MatrixXd &amp;predicted, const Eigen::MatrixXd &amp;labels)</div><div class="ttdoc">Calculates the accuracy of the model.</div><div class="ttdef"><b>Definition</b> Metrics.hpp:23</div></div>
<div class="ttc" id="aclass_n_n_f_s_1_1_model_html"><div class="ttname"><a href="class_n_n_f_s_1_1_model.html">NNFS::Model</a></div><div class="ttdoc">Abstract base class for the model in a neural network.</div><div class="ttdef"><b>Definition</b> Model.hpp:19</div></div>
<div class="ttc" id="aclass_n_n_f_s_1_1_neural_network_html"><div class="ttname"><a href="class_n_n_f_s_1_1_neural_network.html">NNFS::NeuralNetwork</a></div><div class="ttdoc">A neural network model.</div><div class="ttdef"><b>Definition</b> NeuralNetwork.hpp:37</div></div>
<div class="ttc" id="aclass_n_n_f_s_1_1_neural_network_html_a097aea27a1656c01264970b7c5e1883e"><div class="ttname"><a href="class_n_n_f_s_1_1_neural_network.html#a097aea27a1656c01264970b7c5e1883e">NNFS::NeuralNetwork::compile</a></div><div class="ttdeci">void compile()</div><div class="ttdoc">Compiles the neural network model.</div><div class="ttdef"><b>Definition</b> NeuralNetwork.hpp:208</div></div>
<div class="ttc" id="aclass_n_n_f_s_1_1_neural_network_html_a4e9b7be6f4e4309cc086ae631a48fa8f"><div class="ttname"><a href="class_n_n_f_s_1_1_neural_network.html#a4e9b7be6f4e4309cc086ae631a48fa8f">NNFS::NeuralNetwork::predict</a></div><div class="ttdeci">Eigen::MatrixXd predict(const Eigen::MatrixXd &amp;sample)</div><div class="ttdoc">Predicts the class of the provided sample(s).</div><div class="ttdef"><b>Definition</b> NeuralNetwork.hpp:572</div></div>
<div class="ttc" id="aclass_n_n_f_s_1_1_neural_network_html_a5a7d8ad56a8a645f3c80dda9a439cf31"><div class="ttname"><a href="class_n_n_f_s_1_1_neural_network.html#a5a7d8ad56a8a645f3c80dda9a439cf31">NNFS::NeuralNetwork::add_layer</a></div><div class="ttdeci">void add_layer(std::shared_ptr&lt; Layer &gt; layer)</div><div class="ttdoc">Adds a layer to the neural network model.</div><div class="ttdef"><b>Definition</b> NeuralNetwork.hpp:197</div></div>
<div class="ttc" id="aclass_n_n_f_s_1_1_neural_network_html_a7337c868ff69d0f6692cdaf09f140896"><div class="ttname"><a href="class_n_n_f_s_1_1_neural_network.html#a7337c868ff69d0f6692cdaf09f140896">NNFS::NeuralNetwork::accuracy</a></div><div class="ttdeci">void accuracy(double &amp;accuracy, const Eigen::MatrixXd &amp;examples, const Eigen::MatrixXd &amp;labels)</div><div class="ttdoc">Calculates the accuracy of the neural network on the provided examples and labels.</div><div class="ttdef"><b>Definition</b> NeuralNetwork.hpp:552</div></div>
<div class="ttc" id="aclass_n_n_f_s_1_1_neural_network_html_a751e0643136468b84a5beeb8ab7fd9c7"><div class="ttname"><a href="class_n_n_f_s_1_1_neural_network.html#a751e0643136468b84a5beeb8ab7fd9c7">NNFS::NeuralNetwork::load</a></div><div class="ttdeci">void load(std::string path)</div><div class="ttdoc">Loads a model from a file in a custom binary format. The model must have been saved using the NNFS::s...</div><div class="ttdef"><b>Definition</b> NeuralNetwork.hpp:394</div></div>
<div class="ttc" id="aclass_n_n_f_s_1_1_neural_network_html_a8c299a82e81448a966919872973c2c28"><div class="ttname"><a href="class_n_n_f_s_1_1_neural_network.html#a8c299a82e81448a966919872973c2c28">NNFS::NeuralNetwork::save</a></div><div class="ttdeci">void save(std::string path)</div><div class="ttdoc">Saves the model to a file in a custom binary format. The model can be loaded using the NNFS::load met...</div><div class="ttdef"><b>Definition</b> NeuralNetwork.hpp:296</div></div>
<div class="ttc" id="aclass_n_n_f_s_1_1_neural_network_html_acde2d16b041d2c1baf3e0db7fe05e627"><div class="ttname"><a href="class_n_n_f_s_1_1_neural_network.html#acde2d16b041d2c1baf3e0db7fe05e627">NNFS::NeuralNetwork::NeuralNetwork</a></div><div class="ttdeci">NeuralNetwork(std::shared_ptr&lt; Loss &gt; loss=nullptr, std::shared_ptr&lt; Optimizer &gt; optimizer=nullptr)</div><div class="ttdoc">Constructor for NeuralNetwork.</div><div class="ttdef"><b>Definition</b> NeuralNetwork.hpp:45</div></div>
<div class="ttc" id="aclass_n_n_f_s_1_1_neural_network_html_aeba8854f57061e4669ecfa09831c86b6"><div class="ttname"><a href="class_n_n_f_s_1_1_neural_network.html#aeba8854f57061e4669ecfa09831c86b6">NNFS::NeuralNetwork::fit</a></div><div class="ttdeci">void fit(const Eigen::MatrixXd &amp;examples, const Eigen::MatrixXd &amp;labels, const Eigen::MatrixXd &amp;test_examples, const Eigen::MatrixXd &amp;test_labels, int epochs, int batch_size, bool verbose=true) override</div><div class="ttdoc">Fit the neural network model to the given data.</div><div class="ttdef"><b>Definition</b> NeuralNetwork.hpp:64</div></div>
<div class="ttc" id="aclass_n_n_f_s_1_1_softmax_html"><div class="ttname"><a href="class_n_n_f_s_1_1_softmax.html">NNFS::Softmax</a></div><div class="ttdoc">Softmax activation function.</div><div class="ttdef"><b>Definition</b> Softmax.hpp:13</div></div>
<div class="ttc" id="aclass_n_n_f_s_1_1_softmax_html_acf0ead275399fc26f941d7dc521877c5"><div class="ttname"><a href="class_n_n_f_s_1_1_softmax.html#acf0ead275399fc26f941d7dc521877c5">NNFS::Softmax::forward</a></div><div class="ttdeci">void forward(Eigen::MatrixXd &amp;out, const Eigen::MatrixXd &amp;x) override</div><div class="ttdoc">Forward pass of the softmax activation function.</div><div class="ttdef"><b>Definition</b> Softmax.hpp:29</div></div>
<div class="ttc" id="aclue_8hpp_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="clue_8hpp.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition</b> clue.hpp:138</div></div>
<div class="ttc" id="aclue_8hpp_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="clue_8hpp.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition</b> clue.hpp:139</div></div>
<div class="ttc" id="anamespace_n_n_f_s_html"><div class="ttname"><a href="namespace_n_n_f_s.html">NNFS</a></div><div class="ttdef"><b>Definition</b> Activation.hpp:6</div></div>
<div class="ttc" id="anamespace_n_n_f_s_html_a56a4f89587ff9d8a12905fb7ecec9ddf"><div class="ttname"><a href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddf">NNFS::LayerType</a></div><div class="ttdeci">LayerType</div><div class="ttdoc">Enum class for layer types.</div><div class="ttdef"><b>Definition</b> Layer.hpp:12</div></div>
<div class="ttc" id="anamespace_n_n_f_s_html_a56a4f89587ff9d8a12905fb7ecec9ddfa0706fbbd929bd8abc4de386c53d439ff"><div class="ttname"><a href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddfa0706fbbd929bd8abc4de386c53d439ff">NNFS::LayerType::DENSE</a></div><div class="ttdeci">@ DENSE</div></div>
<div class="ttc" id="anamespace_n_n_f_s_html_a56a4f89587ff9d8a12905fb7ecec9ddfaa62e9496bde05da2a14255d4a533bab9"><div class="ttname"><a href="namespace_n_n_f_s.html#a56a4f89587ff9d8a12905fb7ecec9ddfaa62e9496bde05da2a14255d4a533bab9">NNFS::LayerType::ACTIVATION</a></div><div class="ttdeci">@ ACTIVATION</div></div>
<div class="ttc" id="anamespace_n_n_f_s_html_aa9d6e6eda21481bcebb95f187e9a0407"><div class="ttname"><a href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407">NNFS::ActivationType</a></div><div class="ttdeci">ActivationType</div><div class="ttdoc">Enum class for activation types.</div><div class="ttdef"><b>Definition</b> Activation.hpp:11</div></div>
<div class="ttc" id="anamespace_n_n_f_s_html_aa9d6e6eda21481bcebb95f187e9a0407a143c8c6f51b9bb893ce71e38702e3cc1"><div class="ttname"><a href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407a143c8c6f51b9bb893ce71e38702e3cc1">NNFS::ActivationType::TANH</a></div><div class="ttdeci">@ TANH</div></div>
<div class="ttc" id="anamespace_n_n_f_s_html_aa9d6e6eda21481bcebb95f187e9a0407a1d993169621e0855bad00d71c005cf1b"><div class="ttname"><a href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407a1d993169621e0855bad00d71c005cf1b">NNFS::ActivationType::SOFTMAX</a></div><div class="ttdeci">@ SOFTMAX</div></div>
<div class="ttc" id="anamespace_n_n_f_s_html_aa9d6e6eda21481bcebb95f187e9a0407ab299f45b5de2a8f7c45192590290742b"><div class="ttname"><a href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407ab299f45b5de2a8f7c45192590290742b">NNFS::ActivationType::SIGMOID</a></div><div class="ttdeci">@ SIGMOID</div></div>
<div class="ttc" id="anamespace_n_n_f_s_html_aa9d6e6eda21481bcebb95f187e9a0407ab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407ab50339a10e1de285ac99d4c3990b8693">NNFS::ActivationType::NONE</a></div><div class="ttdeci">@ NONE</div></div>
<div class="ttc" id="anamespace_n_n_f_s_html_aa9d6e6eda21481bcebb95f187e9a0407ad346bb4679d29be241279f15d7795c1c"><div class="ttname"><a href="namespace_n_n_f_s.html#aa9d6e6eda21481bcebb95f187e9a0407ad346bb4679d29be241279f15d7795c1c">NNFS::ActivationType::RELU</a></div><div class="ttdeci">@ RELU</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_e35bf39e4fee933b811e79d0e6a4be13.html">NNFS</a></li><li class="navelem"><a class="el" href="dir_a9a0d096714d1b7bc26a819d9f04f360.html">Model</a></li><li class="navelem"><a class="el" href="_neural_network_8hpp.html">NeuralNetwork.hpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
