<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Doxygen Awesome" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<meta property="og:url" content="https://jothepro.github.io/doxygen-awesome-css/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta name="twitter:title" content="Doxygen Awesome" />
<meta name="twitter:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<!-- END twitter metadata -->
<title>NNFS: NNFS - Neural Network From Scratch in C++</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/appxpy/NNFS" class="github-corner" title="View source on GitHub" target="_blank">
    <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <svg width="44" height="44" viewBox="0 0 48 49" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect width="48" height="48" transform="translate(0 0.219971)" fill="var(--page-foreground-color)"/>
        <path d="M13.44 23.22V10.62H15.186L20.856 20.484V10.62H22.422V23.22H20.694L15.024 13.356V23.22H13.44ZM25.3052 23.22V10.62H27.0512L32.7212 20.484V10.62H34.2872V23.22H32.5592L26.8892 13.356V23.22H25.3052ZM13.44 37.22V24.62H20.604V26.096H15.078V30.65H20.604V32.126H15.078V37.22H13.44ZM30.3156 37.508C28.8876 37.508 27.7716 37.13 26.9676 36.374C26.1636 35.618 25.7616 34.562 25.7616 33.206H27.3996C27.3996 34.082 27.6576 34.778 28.1736 35.294C28.7016 35.81 29.4096 36.068 30.2976 36.068C31.0896 36.068 31.7016 35.888 32.1336 35.528C32.5656 35.156 32.7816 34.64 32.7816 33.98C32.7816 33.428 32.6256 32.984 32.3136 32.648C32.0136 32.312 31.4976 32.018 30.7656 31.766L28.6776 31.028C26.9856 30.488 26.1396 29.384 26.1396 27.716C26.1396 26.708 26.5056 25.892 27.2376 25.268C27.9696 24.644 28.9236 24.332 30.0996 24.332C31.3356 24.332 32.3256 24.68 33.0696 25.376C33.8136 26.072 34.1856 27.008 34.1856 28.184H32.5476C32.5476 27.404 32.3316 26.804 31.8996 26.384C31.4676 25.952 30.8496 25.736 30.0456 25.736C29.3496 25.736 28.7976 25.91 28.3896 26.258C27.9936 26.594 27.7956 27.05 27.7956 27.626C27.7956 28.154 27.9696 28.592 28.3176 28.94C28.6656 29.288 29.2296 29.594 30.0096 29.858L31.9536 30.542C33.6096 31.13 34.4376 32.264 34.4376 33.944C34.4376 35.012 34.0596 35.876 33.3036 36.536C32.5596 37.184 31.5636 37.508 30.3156 37.508Z" fill="var(--page-background-color)"/>
    </svg>
  </td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NNFS
   </div>
   <div id="projectbrief">Neural network library from scratch</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="namespace_n_n_f_s.html">NNFS</a> - Neural Network From Scratch in C++ </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__r_e_a_d_m_e"></a> This is a pet project developed by <a href="https://github.com/appxpy">appxpy</a> and <a href="https://github.com/brazenoptimist">brazenoptimist</a> for educational purposes at the Higher School of Economics (HSE) in Moscow. The project aims to build a simple neural network from scratch using C++17.</p>
<p><a class="el" href="namespace_n_n_f_s.html">NNFS</a> includes the header-only core library "NNFS" that allows users to build their custom neural networks for educational purposes. Users can configure layers and activation functions according to their needs.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Getting Started</h1>
<p>To get started with <a class="el" href="namespace_n_n_f_s.html">NNFS</a>, clone the repository and its submodules:</p>
<div class="fragment"><div class="line">git clone --recursive https://github.com/appxpy/NNFS.git</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2"></a>
Prerequisites</h1>
<ul>
<li>C++17 compatible compiler (tested with Clang 14 and GCC 12)</li>
<li>CMake (version 3.14 or higher)</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Building</h1>
<p>To build the project, navigate to the project directory and create a build folder:</p>
<div class="fragment"><div class="line">cd NNFS</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
</div><!-- fragment --><p>And then build with cmake:</p>
<div class="fragment"><div class="line">cmake ..</div>
<div class="line">make</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md4"></a>
Architecture</h1>
<p>The <a class="el" href="namespace_n_n_f_s.html">NNFS</a> project is organized into the following directories:</p>
<ul>
<li><code>include/NNFS</code>: Contains the header-only core library, which includes layers, activation functions, and loss functions.</li>
<li><code>tools</code>: Contains the source code for the built executables for training and interactive paint testing.</li>
<li><code>tests</code>: Contains test cases for the core library using the Google Test framework.</li>
<li><code>external</code>: Contains submodules for the Eigen and Google Test libraries.</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Documentation</h1>
<p>The complete documentation for the <a class="el" href="namespace_n_n_f_s.html">NNFS</a> project can be found at <a href="https://appxpy.github.io/NNFS">appxpy.github.io/NNFS</a>.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Dependencies</h1>
<p>The <a class="el" href="namespace_n_n_f_s.html">NNFS</a> project relies on the following libraries:</p>
<ul>
<li><b>Eigen</b>: A high-level C++ library for linear algebra, which is included as a submodule in the <code>external/eigen</code> directory.</li>
<li><b>Google Test</b>: A C++ testing framework, which is included as a submodule in the <code>external/googletest</code> directory.</li>
</ul>
<h1><a class="anchor" id="autotoc_md7"></a>
Testing</h1>
<p>The <a class="el" href="namespace_n_n_f_s.html">NNFS</a> project was tested using Clang 14 and GCC 12.</p>
<p>To run the tests, navigate to the <code>build</code> directory and execute the following commands:</p>
<div class="fragment"><div class="line">cd tests</div>
<div class="line">./nnfs_tests</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md8"></a>
Examples</h1>
<p>An example of using the <a class="el" href="namespace_n_n_f_s.html">NNFS</a> library to create a custom neural network can be found in the <code>tools</code> directory.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
Training executable</h2>
<p>This program demonstrates how to create and train a neural network using the <a class="el" href="namespace_n_n_f_s.html">NNFS</a> (Neural Network From Scratch) library. The neural network is trained on the MNIST dataset, which consists of handwritten digit images. It could be found in <code><a class="el" href="train_8cpp.html">tools/train.cpp</a></code>.</p>
<p>The program performs the following steps:</p>
<ol type="1">
<li>Fetches the MNIST dataset and preprocesses it by rounding the pixel values to either 0 or 1.</li>
<li>Creates a model with an input layer, two hidden layers with ReLU activation, and an output layer.</li>
<li>Compiles the model by specifying the loss function (cross-entropy softmax) and the optimizer (Adam).</li>
<li>Trains the model on the training dataset with 20 epochs and a batch size of 128.</li>
<li>Saves the trained model to a file.</li>
<li>Loads the model from the file.</li>
<li>Evaluates the model's accuracy on the test dataset.</li>
<li>Makes predictions on a subset of the test dataset and compares them with the actual labels.</li>
</ol>
<h3><a class="anchor" id="autotoc_md10"></a>
Steps to Reproduce</h3>
<p>To create and train your own neural network using the <a class="el" href="namespace_n_n_f_s.html">NNFS</a> library, follow these steps:</p>
<ol type="1">
<li>Install the <a class="el" href="namespace_n_n_f_s.html">NNFS</a> library into your cmake project.</li>
<li>Download and preprocess the MNIST dataset (if not already available) using the fetch_mnist function.</li>
<li>Create the neural network model by adding layers to an instance of <code><a class="el" href="class_n_n_f_s_1_1_neural_network.html" title="A neural network model.">NNFS::NeuralNetwork</a></code> class. For example:</li>
</ol>
<div class="fragment"><div class="line">std::shared_ptr&lt;NNFS::NeuralNetwork&gt; model = std::make_shared&lt;NNFS::NeuralNetwork&gt;();</div>
<div class="line">model-&gt;add_layer(std::make_shared&lt;NNFS::Dense&gt;(784, 128));</div>
<div class="line">model-&gt;add_layer(std::make_shared&lt;NNFS::ReLU&gt;());</div>
<div class="line">model-&gt;add_layer(std::make_shared&lt;NNFS::Dense&gt;(128, 128));</div>
<div class="line">model-&gt;add_layer(std::make_shared&lt;NNFS::ReLU&gt;());</div>
<div class="line">model-&gt;add_layer(std::make_shared&lt;NNFS::Dense&gt;(128, 10));</div>
</div><!-- fragment --><ol type="1">
<li>Compile the model by calling the compile method:</li>
</ol>
<div class="fragment"><div class="line">model-&gt;compile();</div>
</div><!-- fragment --><ol type="1">
<li>Train the model on the training dataset using the <code>fit</code> method. Specify the number of epochs and the batch size. For example:</li>
</ol>
<div class="fragment"><div class="line">model-&gt;fit(x_train, y_train, x_test, y_test, 20, 128);</div>
</div><!-- fragment --><ol type="1">
<li>Save the trained model to a file using the <code>save</code> method:</li>
</ol>
<div class="fragment"><div class="line">std::string file_path = <span class="stringliteral">&quot;path/to/save/model.bin&quot;</span>;</div>
<div class="line">model-&gt;save(file_path);</div>
</div><!-- fragment --><ol type="1">
<li>Load the saved model from the file using the <code>load</code> method:</li>
</ol>
<div class="fragment"><div class="line">std::shared_ptr&lt;NNFS::NeuralNetwork&gt; model = std::make_shared&lt;NNFS::NeuralNetwork&gt;();</div>
<div class="line">model-&gt;load(file_path);</div>
</div><!-- fragment --><ol type="1">
<li>Evaluate the model's accuracy on the test dataset using the <code>accuracy</code> method:</li>
</ol>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> accuracy;</div>
<div class="line">model-&gt;accuracy(accuracy, x_test, y_test);</div>
<div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;Test set accuracy: &quot;</span> &lt;&lt; accuracy &lt;&lt; std::endl;</div>
</div><!-- fragment --><ol type="1">
<li>Make predictions using the <code>predict</code> method. Pass the input data to the method and obtain the predicted outputs:</li>
</ol>
<div class="fragment"><div class="line">Eigen::MatrixXd predictions = model-&gt;predict(input_data);</div>
</div><!-- fragment --><ol type="1">
<li>Perform any necessary post-processing on the predictions and compare them with the actual labels to evaluate the model's performance.</li>
</ol>
<p>Please note that this is a simplified explanation of the code. Additional code and configuration may be required depending on the specific implementation and requirements. If you need more information, please, follow the <a href="https://appxpy.github.io/NNFS">documentation</a>.</p>
<hr  />
<h2><a class="anchor" id="autotoc_md12"></a>
Paint application</h2>
<p>This interactive paint application allows users to draw on a canvas using a mouse and predicts the digit represented by the user's drawing using a neural network. The application is built using the Qt framework and the project's <a class="el" href="namespace_n_n_f_s.html">NNFS</a> library.</p>
<h3><a class="anchor" id="autotoc_md13"></a>
Features</h3>
<ul>
<li>Draw freely on the canvas using the mouse.</li>
<li>Real-time prediction of the digit based on the user's drawing.</li>
<li>Display of prediction probabilities for each digit.</li>
<li>Highlighting of the predicted digit.</li>
</ul>
<h3><a class="anchor" id="autotoc_md14"></a>
Running the application</h3>
<p>To run the paint application, follow these steps:</p>
<ol type="1">
<li>Ensure that you have CMake (version 3.5 or higher) installed on your system.</li>
<li>Clone the repository and navigate to the project directory.</li>
<li>Build the project using CMake: <div class="fragment"><div class="line">cmake .</div>
<div class="line">make</div>
</div><!-- fragment --></li>
<li>Run the application, executable for your OS will be located into <code>build/tools/paint</code> folder.</li>
<li>As you draw, the application will predict the digit based on your drawing in real-time. The predicted digit, along with the prediction probabilities for each digit, will be displayed.</li>
<li>To clear the canvas and start a new drawing, click the "Restart" button.</li>
</ol>
<h3><a class="anchor" id="autotoc_md15"></a>
Example Usage</h3>
<p><img src="https://github.com/appxpy/NNFS/blob/main/example.gif?raw=True" alt="" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md16"></a>
Contributing</h1>
<p>We welcome contributions from anyone interested in improving the <a class="el" href="namespace_n_n_f_s.html">NNFS</a> project. If you find a bug or have an idea for a new feature, please open an issue on the GitHub repository.</p>
<p>If you would like to contribute to the project, please follow these steps:</p>
<ol type="1">
<li>Fork the repository and clone it to your local machine.</li>
<li>Create a new branch for your changes.</li>
<li>Make your changes and test them thoroughly.</li>
<li>Commit your changes with a clear and descriptive message.</li>
<li>Push your changes to your forked repository.</li>
<li>Open a pull request on the GitHub repository.</li>
</ol>
<p>Please note that all contributions are subject to review by the project maintainers.</p>
<h1><a class="anchor" id="autotoc_md17"></a>
License</h1>
<p>This project is licensed under the <b>MIT License</b>. Please see the LICENSE file for more information.</p>
<hr  />
<p>made with ❤️ by <a href="https://github.com/appxpy">appxpy</a> &amp; <a href="https://github.com/brazenoptimist">brazenoptimist</a> </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
